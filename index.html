<!DOCTYPE html>
<script src="https://d3js.org/d3.v6.js"></script>

<!-- Add a title -->
<h1>Represenation of Minorities at the Oscars</h1>

<!-- Add a bit of text -->
<p>Minority representation is very low at the Oscars. Between 1935 and 2019 less than 5% of all nominees were POC.</p>

<svg width=600 height=600></svg>

<body onload="init()"></body>
<script>
    async function init() {

        var margin = 50
        width = 500
        height = 500;
        var data = await d3.csv("oscars.csv");

        var noms = [0,0];
        var wins = [0,0];
        var totals = [0,0];
        console.log(data)
        for (var i = 0; i < data.length; i++) {
            if (data[i].Race === "White") {
                noms[0]++
                if (data[i].winner === "TRUE") {
                    wins[0]++;
                    totals[1]++;
                }
            } else {
                noms[1]++;
                if (data[i].winner === "TRUE") {
                    wins[1]++;
                    totals[1]++;
                }
            }
            totals[0]++;
        }
        console.log(totals)
        var noms_pct = [noms[0]/totals[0], noms[1]/totals[0]];
        var wins_pct = [wins[0]/totals[1], wins[1]/totals[1]];
        console.log(wins_pct);
        console.log(noms_pct);
        var categories = ["White","POC"];

        var y = d3.scaleLinear().domain([0,1]).range([height,0]);
        var x = d3.scaleBand().domain(categories).range([0,250]);
        var colors = ["blue","green"];

        d3.select("svg")
        .attr("width", width+margin*2)
        .attr("height", height+margin*2)
        .append("g")
            .attr("transform","translate("+margin+","+margin+")")
        .selectAll().data(noms_pct)
        .enter().append("rect")
            .attr("width", 50)
            .attr("height", function(d) { return d*height;})
            .attr("x", function(d,i) {return 100*i+50;})
            .attr("y", function(d) {return height-d*height})
            .attr("fill", function(d,i) { return colors[i]});


        d3.select("svg").append("g")
          .attr("transform","translate("+margin+","+margin+")")
          .call(d3.axisLeft(y));


            
    }
</script>
